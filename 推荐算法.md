### *推荐系统的传统匹配模型*

- 基于 Collaborative Filtering 的方法

  - 分类

    - User-base CF：通过对用户喜欢的 item 进行分析，如果用户 a 和用户 b 喜欢过的 item 差不多，那么用户 a 和 b 是相似的。类似朋友推荐一样，可以将 b 喜欢过但是 a 没有看过的 item 推荐给 a
    - Item-base CF: item A 和 item B 如果被差不多的人喜欢，认为 item A 和 item B是相似的。用户如果喜欢 item A，那么给用户推荐 item B 大概率也是喜欢的。
    - Model-base CF: 也叫基于学习的方法，通过定义一个参数模型来描述用户和物品、用户和用户、物品和物品之间的关系，然后通过已有的用户-物品评分矩阵来优化求解得到参数。例如矩阵分解、隐语义模型 LFM 等。

  - 问题本质：矩阵的未知部分如何填充问题 。已知的值是用户已经交互过的 item，如何基于这些已知值填充矩阵剩下的未知值，也就是去预测用户没有交互过的 item 是矩阵填充要解决的问题。

     ![image-20200628113636962](C:\Users\leade\AppData\Roaming\Typora\typora-user-images\image-20200628113636962.png)
    - SVD ( Singular Value Decomposition )

      - 步骤

        - 对 M 矩阵的 missing data 填充为0

        - 求解 SVD 问题，得到 U 矩阵和 V 矩阵

          ![image-20200628113849492](C:\Users\leade\AppData\Roaming\Typora\typora-user-images\image-20200628113849492.png)

        - 利用 U 和 V 矩阵的低秩 k 维矩阵来估计

      - 缺点

        - Missing data 和 observe data 权重一样
        - 最小化过程没有正则化 ( 只有最小方差 )，容易产生过拟合。

    - MF 模型 ( 矩阵分解 )

      - 步骤

        - 将用户 u 对物品 i 的打分分解成用户的隐向量 vu，以及物品的隐向量 vi；

          ![image-20200628114252313](C:\Users\leade\AppData\Roaming\Typora\typora-user-images\image-20200628114252313.png)

        - 用户 u 和物品 i 的向量点积 ( inner product ) 得到的 value，可以用来代表
          用户 u 对物品i的喜好程度，分数越高代表该 item 推荐给用户的概率就越
          大。同时，MF 模型引入了 L2 正则来解决过拟合问题。

          ![image-20200628114358676](C:\Users\leade\AppData\Roaming\Typora\typora-user-images\image-20200628114358676.png)

    - FISM（Factored Item Similarity Model）

      - 用户表达不再是独立的隐向量，而是用用户喜欢过的所有 item 的累加求和得
        到作为 user 的表达；而 item 本身的隐向量 vi 是另一套表示，两者最终同样
        用向量内积表示。

        ![image-20200628114539868](C:\Users\leade\AppData\Roaming\Typora\typora-user-images\image-20200628114539868.png)

    -  SVD++

      - MF 模型可以看成是 user-based 的 CF 模型，直接将用户id映射成隐向量，而
        FISM 模型可以看成是 item-based 的 CF 模型，将用户交户过的 item 的集合
        映射成隐向量。SVD++ 方法正是这两者的结合：每个用户表达分成两个部
        分，左边 vu 表示用户 id 映射的隐向量 ( user-based CF 思想 )，右边是用户交
        互过的 item 集合的求和 ( item-based CF 思想 )。User 和 item 的相似度还是
        用向量点击来表达。

        ![image-20200628114642838](C:\Users\leade\AppData\Roaming\Typora\typora-user-images\image-20200628114642838.png)

  - 缺点

    - 只是利用了 user 和 item 的交互信息 ( rating data )，而对于大量的 side
      information 信息没有利用到。例如 user 本身的信息，如年龄，性别、职业；item
      本身的 side information，如分类，描述，图文信息；以及 context 上下文信息，
      如位置，时间，天气等